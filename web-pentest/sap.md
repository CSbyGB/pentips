# Pentest SAP

If you have to test SAP, here are a few intersting things to check.

## SAP BusinessObjects Business Intelligence platform - Query Builder

### Lookup for users

- Say you have creds for basic user and creds for admin.
- Check out if you can access this page https://target/AdminTools/querybuilder/ie.jsp and log in.
- Compare what you get depending to the user you query with (for example a simple user should be able to list users)
- Once logged in, one thing to do is to see if you user is able to list the users with this SQL Request. This query should do: `SELECT * FROM CI_SYSTEMOBJECTS WHERE SI_KIND='USER'`

### Other useful queries

```sql
SELECT * FROM CI_SYSTEMOBJECTS WHERE SI_KIND='USR02'
SELECT * FROM CI_SYSTEMOBJECTS WHERE SI_KIND='USH02'
SELECT * FROM CI_SYSTEMOBJECTS WHERE SI_KIND='USRPWDHISTORY'
SELECT * FROM CI_SYSTEMOBJECTS WHERE SI_KIND='USH02_ARC_TMP'
SELECT * FROM CI_SYSTEMOBJECTS WHERE SI_KIND='VUSER001'
SELECT * FROM CI_SYSTEMOBJECTS WHERE SI_KIND='VPWD_USR02'
SELECT * FROM CI_SYSTEMOBJECTS
SELECT * FROM CI_SYSTEMOBJECTS WHERE SI_NAME='username'
```

## SAP CVE

- [SAP CVE](https://www.cvedetails.com/vulnerability-list/vendor_id-797/cvssscoremin-9/cvssscoremax-/SAP.html)
- [CVE-2020-6218](https://www.cvedetails.com/cve/CVE-2020-6218/)

## Resources

- [SAP Passwords Hashes Security](https://blogs.sap.com/2020/06/25/sap-password-hashes-security/)